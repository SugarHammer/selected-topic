{"version":3,"sources":["../../src/mini-adapter/register.ts"],"names":["devicePixelRatio","Mixin","canvas","canvas2D","registerCanvas","c","id","tagName","type","parentNode","style","classList","clientRegion","offsetRegion","focus","blur","registerCanvas2D","ctx","width","height","clientWidth","clientHeight","getContext","getCanvas","getCanvas2D"],"mappings":"AAEA,OAAOA,gBAAP,MAA6B,oBAA7B;AACA,OAAO,KAAKC,KAAZ,MAAuB,cAAvB;AAKA,IAAIC,MAAW,GAAG,EAAlB;AACA,IAAIC,QAAa,GAAG,EAApB;;AAGA,SAASC,cAAT,CAAwBC,CAAxB,EAA2BC,EAA3B,EAAuC;AACrCJ,EAAAA,MAAM,GAAGG,CAAT;AACAH,EAAAA,MAAM,CAACI,EAAP,GAAYA,EAAZ;;AAEA,MAAI,EAAE,aAAaJ,MAAf,CAAJ,EAA4B;AAC1BA,IAAAA,MAAM,CAACK,OAAP,GAAiB,QAAjB;AACD;;AAEDL,EAAAA,MAAM,CAACM,IAAP,GAAc,QAAd;AAEAP,EAAAA,KAAK,CAACQ,UAAN,CAAiBP,MAAjB;AACAD,EAAAA,KAAK,CAACS,KAAN,CAAYR,MAAZ;AACAD,EAAAA,KAAK,CAACU,SAAN,CAAgBT,MAAhB;AACAD,EAAAA,KAAK,CAACW,YAAN,CAAmBV,MAAnB;AACAD,EAAAA,KAAK,CAACY,YAAN,CAAmBX,MAAnB;;AAEAA,EAAAA,MAAM,CAACY,KAAP,GAAe,YAAW,CAAE,CAA5B;;AACAZ,EAAAA,MAAM,CAACa,IAAP,GAAc,YAAW,CAAE,CAA3B;AAaD;;AAGD,SAASC,gBAAT,CAA0BC,GAA1B,EAA+BX,EAA/B,EAA2C;AACzC,MAAMY,KAAK,GAAG,IAAd;AACA,MAAMC,MAAM,GAAG,IAAf;AACAhB,EAAAA,QAAQ,GAAG;AACTe,IAAAA,KAAK,EAALA,KADS;AAETC,IAAAA,MAAM,EAANA,MAFS;AAGTC,IAAAA,WAAW,EAAEF,KAAK,GAAGlB,gBAHZ;AAITqB,IAAAA,YAAY,EAAEF,MAAM,GAAGnB,gBAJd;AAKTM,IAAAA,EAAE,EAAFA,EALS;AAMTE,IAAAA,IAAI,EAAE;AANG,GAAX;;AASA,MAAI,EAAE,aAAaL,QAAf,CAAJ,EAA8B;AAC5BA,IAAAA,QAAQ,CAACI,OAAT,GAAmB,QAAnB;AACD;;AAEDN,EAAAA,KAAK,CAACQ,UAAN,CAAiBN,QAAjB;AACAF,EAAAA,KAAK,CAACS,KAAN,CAAYP,QAAZ;AACAF,EAAAA,KAAK,CAACU,SAAN,CAAgBR,QAAhB;AACAF,EAAAA,KAAK,CAACW,YAAN,CAAmBT,QAAnB;AACAF,EAAAA,KAAK,CAACY,YAAN,CAAmBV,QAAnB;;AAEAA,EAAAA,QAAQ,CAACmB,UAAT,GAAsB,UAASd,IAAT,EAAe;AACnC,QAAIA,IAAI,KAAK,IAAb,EAAmB;AACjB,aAAOS,GAAP;AACD;AACF,GAJD;;AAKAd,EAAAA,QAAQ,CAACW,KAAT,GAAiB,YAAW,CAAE,CAA9B;;AACAX,EAAAA,QAAQ,CAACY,IAAT,GAAgB,YAAW,CAAE,CAA7B;AAaD;;AAGD,SAASQ,SAAT,GAAqB;AACnB,SAAOrB,MAAP;AACD;;AAGD,SAASsB,WAAT,GAAuB;AACrB,SAAOrB,QAAP;AACD;;AAED,SAASC,cAAT,EAAyBY,gBAAzB,EAA2CO,SAA3C,EAAsDC,WAAtD","sourcesContent":["// @ts-nocheck\n// tslint:disable\nimport devicePixelRatio from './devicePixelRatio';\nimport * as Mixin from './util/mixin';\n\ndeclare let my: any;\n\n// 同步和异步都需要的数据\nlet canvas: any = {};\nlet canvas2D: any = {};\n\n// 异步注册3Dcanvas\nfunction registerCanvas(c, id: string) {\n  canvas = c;\n  canvas.id = id;\n\n  if (!('tagName' in canvas)) {\n    canvas.tagName = 'CANVAS';\n  }\n\n  canvas.type = 'canvas';\n\n  Mixin.parentNode(canvas);\n  Mixin.style(canvas);\n  Mixin.classList(canvas);\n  Mixin.clientRegion(canvas);\n  Mixin.offsetRegion(canvas);\n\n  canvas.focus = function() {};\n  canvas.blur = function() {};\n  // Tip: 小程序中无法动态注册事件\n  // canvas.addEventListener = function(type, listener, options = {}) {\n  //   document.addEventListener(type, listener, options);\n  // };\n\n  // canvas.removeEventListener = function(type, listener) {\n  //   document.removeEventListener(type, listener);\n  // };\n\n  // canvas.dispatchEvent = function(event: any) {\n  //   document.dispatchEvent(event);\n  // };\n}\n\n// 异步注册2Dcanvas\nfunction registerCanvas2D(ctx, id: string) {\n  const width = 1024;\n  const height = 1024;\n  canvas2D = {\n    width,\n    height,\n    clientWidth: width / devicePixelRatio,\n    clientHeight: height / devicePixelRatio,\n    id,\n    type: 'canvas',\n  };\n\n  if (!('tagName' in canvas2D)) {\n    canvas2D.tagName = 'CANVAS';\n  }\n\n  Mixin.parentNode(canvas2D);\n  Mixin.style(canvas2D);\n  Mixin.classList(canvas2D);\n  Mixin.clientRegion(canvas2D);\n  Mixin.offsetRegion(canvas2D);\n\n  canvas2D.getContext = function(type) {\n    if (type === '2d') {\n      return ctx;\n    }\n  };\n  canvas2D.focus = function() {};\n  canvas2D.blur = function() {};\n  // Tip: 小程序中无法动态注册事件\n  // canvas2D.addEventListener = function(type, listener, options = {}) {\n  //   document.addEventListener(type, listener, options);\n  // };\n\n  // canvas2D.removeEventListener = function(type, listener) {\n  //   document.removeEventListener(type, listener);\n  // };\n\n  // canvas2D.dispatchEvent = function(event: any) {\n  //   document.dispatchEvent(event);\n  // };\n}\n\n// 异步获取3Dcanvas\nfunction getCanvas() {\n  return canvas;\n}\n\n// 异步获取2Dcanvas\nfunction getCanvas2D() {\n  return canvas2D;\n}\n\nexport { registerCanvas, registerCanvas2D, getCanvas, getCanvas2D };\n"],"file":"register.js"}