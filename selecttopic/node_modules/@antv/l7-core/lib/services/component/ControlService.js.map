{"version":3,"sources":["../../../src/services/component/ControlService.ts"],"names":["ControlService","cfg","sceneContainer","container","scene","mapsService","get","TYPES","IMapService","initControlPos","ctr","map","addTo","controls","push","unAddControls","name","find","controlOption","index","indexOf","splice","remove","forEach","clearControlPos","corners","controlCorners","l","controlContainer","DOM","create","createCorner","vSideList","className","item","join","i"],"mappings":"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","sourcesContent":["import { DOM } from '@antv/l7-utils';\nimport { Container, injectable } from 'inversify';\nimport 'reflect-metadata';\nimport { TYPES } from '../../types';\nimport { IMapService } from '../map/IMapService';\nimport {\n  IControl,\n  IControlCorners,\n  IControlService,\n  IControlServiceCfg,\n} from './IControlService';\n@injectable()\nexport default class ControlService implements IControlService {\n  public container: HTMLElement;\n  public controlCorners: IControlCorners;\n  public controlContainer: HTMLElement;\n  public scene: Container;\n  public mapsService: IMapService;\n  private controls: IControl[] = [];\n  private unAddControls: IControl[] = [];\n  public init(cfg: IControlServiceCfg, sceneContainer: Container) {\n    this.container = cfg.container;\n    this.scene = sceneContainer;\n    this.mapsService = sceneContainer.get<IMapService>(TYPES.IMapService);\n    this.initControlPos();\n  }\n  public addControl(ctr: IControl, sceneContainer: Container): void {\n    const mapsService = sceneContainer.get<IMapService>(TYPES.IMapService);\n    if (mapsService.map) {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    } else {\n      this.unAddControls.push(ctr);\n    }\n  }\n  public getControlByName(name: string | number): IControl | undefined {\n    return this.controls.find((ctr) => {\n      return ctr.controlOption.name === name;\n    });\n  }\n  public removeControl(ctr: IControl): this {\n    const index = this.controls.indexOf(ctr);\n    if (index > -1) {\n      this.controls.splice(index, 1);\n    }\n    ctr.remove();\n    return this;\n  }\n\n  public addControls() {\n    this.unAddControls.forEach((ctr: IControl) => {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    });\n    this.unAddControls = [];\n  }\n\n  public destroy(): void {\n    for (const ctr of this.controls) {\n      ctr.remove();\n    }\n    this.controls = [];\n    this.clearControlPos();\n  }\n\n  private initControlPos() {\n    const corners: IControlCorners = (this.controlCorners = {});\n    const l = 'l7-';\n    const container = (this.controlContainer = DOM.create(\n      'div',\n      l + 'control-container',\n      this.container,\n    ));\n\n    function createCorner(vSideList: string[] = []) {\n      const className = vSideList.map((item) => l + item).join(' ');\n      corners[vSideList.join('')] = DOM.create('div', className, container);\n    }\n\n    createCorner(['top', 'left']);\n    createCorner(['top', 'right']);\n    createCorner(['bottom', 'left']);\n    createCorner(['bottom', 'right']);\n\n    createCorner(['top', 'center']);\n    createCorner(['right', 'center']);\n    createCorner(['left', 'center']);\n    createCorner(['bottom', 'center']);\n  }\n\n  private clearControlPos() {\n    for (const i in this.controlCorners) {\n      if (this.controlCorners[i]) {\n        DOM.remove(this.controlCorners[i]);\n      }\n    }\n    if (this.controlContainer) {\n      DOM.remove(this.controlContainer);\n    }\n    delete this.controlCorners;\n    delete this.controlContainer;\n  }\n}\n"],"file":"ControlService.js"}