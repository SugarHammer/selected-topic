{"version":3,"sources":["../../src/control/BaseControl.ts"],"names":["PositionType","TYPES","DOM","EventEmitter","controlId","Control","cfg","controlOption","getDefault","position","TOPRIGHT","name","BOTTOMRIGHT","controlService","removeControl","addControl","sceneContainer","mapsService","get","IMapService","renderService","IRendererService","layerService","ILayerService","IControlService","isShow","container","onAdd","pos","corner","controlCorners","addClass","indexOf","insertBefore","firstChild","appendChild","Error","removeClass","remove","onRemove","e","screenX","screenY","getContainer","focus"],"mappings":"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","sourcesContent":["import {\n  IControlOption,\n  IControlService,\n  ILayerService,\n  IMapService,\n  IRendererService,\n  PositionType,\n  TYPES,\n} from '@antv/l7-core';\nimport { DOM } from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nimport { Container } from 'inversify';\n\nexport { PositionType } from '@antv/l7-core';\n\nlet controlId = 0;\nexport default class Control extends EventEmitter {\n  public controlOption: IControlOption;\n  protected container: HTMLElement;\n  protected sceneContainer: Container;\n  protected mapsService: IMapService;\n  protected renderService: IRendererService;\n  protected layerService: ILayerService;\n  protected controlService: IControlService;\n\n  private isShow: boolean;\n\n  constructor(cfg?: Partial<IControlOption>) {\n    super();\n    this.controlOption = {\n      ...this.getDefault(),\n      ...(cfg || {}),\n    };\n  }\n\n  public getDefault() {\n    return {\n      position: PositionType.TOPRIGHT,\n      name: `${controlId++}`,\n    };\n  }\n\n  public setPosition(position: PositionType = PositionType.BOTTOMRIGHT) {\n    // 考虑组件的自动布局，需要销毁重建\n    const controlService = this.controlService;\n    if (controlService) {\n      controlService.removeControl(this);\n    }\n    this.controlOption.position = position;\n    if (controlService) {\n      controlService.addControl(this, this.sceneContainer);\n    }\n    return this;\n  }\n  public addTo(sceneContainer: Container) {\n    this.mapsService = sceneContainer.get<IMapService>(TYPES.IMapService);\n    this.renderService = sceneContainer.get<IRendererService>(\n      TYPES.IRendererService,\n    );\n    this.layerService = sceneContainer.get<ILayerService>(TYPES.ILayerService);\n    this.controlService = sceneContainer.get<IControlService>(\n      TYPES.IControlService,\n    );\n    this.sceneContainer = sceneContainer;\n    this.isShow = true;\n    this.container = this.onAdd();\n    const container = this.container;\n    const pos = this.controlOption.position;\n    const corner = this.controlService.controlCorners[pos];\n    DOM.addClass(container, 'l7-control');\n\n    if (pos.indexOf('bottom') !== -1) {\n      corner.insertBefore(container, corner.firstChild);\n    } else {\n      corner.appendChild(container);\n    }\n    return this;\n  }\n  public onAdd(): HTMLElement {\n    throw new Error('Method not implemented.');\n  }\n\n  public onRemove(): void {\n    throw new Error('Method not implemented.');\n  }\n  public hide() {\n    const container = this.container;\n    DOM.addClass(container, 'l7-control-hide');\n    this.isShow = false;\n  }\n  public show() {\n    const container = this.container;\n    DOM.removeClass(container, 'l7-control-hide');\n    this.isShow = true;\n  }\n  public remove() {\n    if (!this.mapsService) {\n      return this;\n    }\n    DOM.remove(this.container);\n    this.onRemove();\n  }\n  public _refocusOnMap(e: MouseEvent) {\n    // if map exists and event is not a keyboard event\n    if (this.mapsService && e && e.screenX > 0 && e.screenY > 0) {\n      const container = this.mapsService.getContainer();\n      if (container !== null) {\n        container.focus();\n      }\n    }\n  }\n}\n"],"file":"BaseControl.js"}