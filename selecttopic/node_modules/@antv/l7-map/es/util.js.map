{"version":3,"sources":["../src/util.ts"],"names":["$window","isMini","UnitBezier","reducedMotionQuery","wrap","n","min","max","d","w","clamp","Math","interpolate","a","b","t","bezier","p1x","p1y","p2x","p2y","bez","solve","ease","prefersReducedMotion","matchMedia","matches","pick","src","properties","result","name","now","Date","bind","performance","raf","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancel","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","renderframe","fn","frame"],"mappings":"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","sourcesContent":["import { $window, isMini } from '@antv/l7-utils';\n// @ts-ignore\nimport UnitBezier from '@mapbox/unitbezier';\nlet reducedMotionQuery: MediaQueryList;\nexport interface ICancelable {\n  cancel: () => void;\n}\nexport function wrap(n: number, min: number, max: number): number {\n  const d = max - min;\n  const w = ((((n - min) % d) + d) % d) + min;\n  return w === min ? max : w;\n}\n\nexport function clamp(n: number, min: number, max: number): number {\n  return Math.min(max, Math.max(min, n));\n}\n\nexport function interpolate(a: number, b: number, t: number) {\n  return a * (1 - t) + b * t;\n}\nexport function bezier(\n  p1x: number,\n  p1y: number,\n  p2x: number,\n  p2y: number,\n): (t: number) => number {\n  const bez = new UnitBezier(p1x, p1y, p2x, p2y);\n  return (t: number) => {\n    return bez.solve(t);\n  };\n}\n\nexport const ease = bezier(0.25, 0.1, 0.25, 1);\n\nexport function prefersReducedMotion(): boolean {\n  // @ts-ignore\n  if (isMini || !$window.matchMedia) {\n    return false;\n  }\n  // Lazily initialize media query\n  if (reducedMotionQuery == null) {\n    // @ts-ignore\n    reducedMotionQuery = $window.matchMedia('(prefers-reduced-motion: reduce)');\n  }\n  return reducedMotionQuery.matches;\n}\n\nexport function pick(\n  src: { [key: string]: any },\n  properties: string[],\n): { [key: string]: any } {\n  const result: { [key: string]: any } = {};\n  for (const name of properties) {\n    if (name in src) {\n      result[name] = src[name];\n    }\n  }\n  return result;\n}\n\nexport const now = isMini\n  ? Date.now.bind(Date)\n  : $window.performance && $window.performance.now\n  ? $window.performance.now.bind($window.performance)\n  : Date.now.bind(Date);\n\nexport const raf =\n  $window.requestAnimationFrame ||\n  // @ts-ignore\n  $window.mozRequestAnimationFrame ||\n  // @ts-ignore\n  $window.webkitRequestAnimationFrame ||\n  // @ts-ignore\n  $window.msRequestAnimationFrame;\n\nexport const cancel =\n  $window.cancelAnimationFrame ||\n  // @ts-ignore\n  $window.mozCancelAnimationFrame ||\n  // @ts-ignore\n  $window.webkitCancelAnimationFrame ||\n  // @ts-ignore\n  $window.msCancelAnimationFrame;\n\nexport function renderframe(\n  fn: (paintStartTimestamp: number) => void,\n): ICancelable {\n  const frame = raf(fn);\n  return { cancel: () => cancel(frame) };\n}\n"],"file":"util.js"}