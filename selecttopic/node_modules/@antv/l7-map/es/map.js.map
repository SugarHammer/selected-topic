{"version":3,"sources":["../src/map.ts"],"names":["$window","DOM","isMini","Camera","LngLat","LngLatBounds","Point","HandlerManager","Hash","renderframe","PerformanceUtils","TaskQueue","defaultMinZoom","defaultMaxZoom","defaultMinPitch","defaultMaxPitch","DefaultOptions","hash","zoom","center","pitch","bearing","interactive","minZoom","maxZoom","minPitch","maxPitch","scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch","bearingSnap","clickTolerance","pitchWithRotate","trackResize","renderWorldCopies","pitchEnabled","rotateEnabled","Map","options","update","event","resize","originalEvent","initMiniContainer","initContainer","handlers","window","addEventListener","onWindowOnline","onWindowResize","hashName","undefined","addTo","onHashChange","jumpTo","bounds","fitBounds","fitBoundsOptions","duration","eventData","dimensions","containerDimensions","width","height","transform","fireMoving","moving","stop","emit","Event","container","canvas","canvasContainer","lngLat","locationPoint","convert","point","pointLocation","getBounds","getMaxBounds","setMaxBounds","style","getZoom","setZoom","Error","getPitch","setPitch","frame","cancel","renderTaskQueue","clear","cb","add","id","remove","paintStartTimeStamp","time","run","document","getElementById","HTMLElement","classList","create","devicePixelRatio","clientWidth","clientHeight"],"mappings":"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","sourcesContent":["import { $window, DOM, isMini } from '@antv/l7-utils';\nimport { merge } from 'lodash';\nimport Camera from './camera';\nimport './css/l7.css';\nimport LngLat, { LngLatLike } from './geo/lng_lat';\nimport LngLatBounds, { LngLatBoundsLike } from './geo/lng_lat_bounds';\n// @ts-ignore\nimport Point, { PointLike } from './geo/point';\nimport BoxZoomHandler from './handler/box_zoom';\nimport HandlerManager from './handler/handler_manager';\nimport KeyboardHandler from './handler/keyboard';\n\nimport ScrollZoomHandler from './handler/scroll_zoom';\nimport DoubleClickZoomHandler from './handler/shim/dblclick_zoom';\nimport DragPanHandler from './handler/shim/drag_pan';\nimport DragRotateHandler from './handler/shim/drag_rotate';\nimport TouchZoomRotateHandler from './handler/shim/touch_zoom_rotate';\nimport { TouchPitchHandler } from './handler/touch';\nimport Hash from './hash';\nimport { IMapOptions } from './interface';\nimport { renderframe } from './util';\nimport { PerformanceUtils } from './utils/performance';\nimport TaskQueue, { TaskID } from './utils/task_queue';\ntype CallBack = (_: number) => void;\nconst defaultMinZoom = -2;\nconst defaultMaxZoom = 22;\n\n// the default values, but also the valid range\nconst defaultMinPitch = 0;\nconst defaultMaxPitch = 60;\n\nconst DefaultOptions: IMapOptions = {\n  hash: false,\n  zoom: -1,\n  center: [112, 32],\n  pitch: 0,\n  bearing: 0,\n  interactive: true,\n  minZoom: defaultMinZoom,\n  maxZoom: defaultMaxZoom,\n  minPitch: defaultMinPitch,\n  maxPitch: defaultMaxPitch,\n  scrollZoom: true,\n  boxZoom: true,\n  dragRotate: true,\n  dragPan: true,\n  keyboard: true,\n  doubleClickZoom: true,\n  touchZoomRotate: true,\n  touchPitch: true,\n  bearingSnap: 7,\n  clickTolerance: 3,\n  pitchWithRotate: true,\n  trackResize: true,\n  renderWorldCopies: true,\n  pitchEnabled: true,\n  rotateEnabled: true,\n};\nexport class Map extends Camera {\n  public doubleClickZoom: DoubleClickZoomHandler;\n  public dragRotate: DragRotateHandler;\n  public dragPan: DragPanHandler;\n  public touchZoomRotate: TouchZoomRotateHandler;\n  public scrollZoom: ScrollZoomHandler;\n  public keyboard: KeyboardHandler;\n  public touchPitch: TouchPitchHandler;\n  public boxZoom: BoxZoomHandler;\n  public handlers: HandlerManager;\n\n  private container: HTMLElement;\n  private canvas: HTMLCanvasElement;\n  private canvasContainer: HTMLElement;\n  private renderTaskQueue: TaskQueue = new TaskQueue();\n  private frame: { cancel: () => void } | null;\n  private trackResize: boolean = true;\n  private hash: Hash | undefined;\n  constructor(options: Partial<IMapOptions>) {\n    super(merge({}, DefaultOptions, options));\n    if (isMini) {\n      this.initMiniContainer();\n    } else {\n      this.initContainer();\n    }\n\n    this.resize();\n    this.handlers = new HandlerManager(this, this.options);\n\n    if (typeof window !== 'undefined') {\n      window.addEventListener('online', this.onWindowOnline, false);\n      window.addEventListener('resize', this.onWindowResize, false);\n      window.addEventListener('orientationchange', this.onWindowResize, false);\n    }\n\n    if (!isMini) {\n      const hashName =\n        (typeof options.hash === 'string' && options.hash) || undefined;\n      if (options.hash) {\n        this.hash = new Hash(hashName).addTo(this) as Hash;\n      }\n    }\n\n    // don't set position from options if set through hash\n    if (!this.hash || !this.hash.onHashChange()) {\n      this.jumpTo({\n        center: options.center,\n        zoom: options.zoom,\n        bearing: options.bearing,\n        pitch: options.pitch,\n      });\n\n      if (options.bounds) {\n        this.resize();\n        this.fitBounds(\n          options.bounds,\n          merge({}, options.fitBoundsOptions, { duration: 0 }),\n        );\n      }\n    }\n  }\n\n  public resize(eventData?: any) {\n    const dimensions = this.containerDimensions();\n    const width = dimensions[0];\n    const height = dimensions[1];\n\n    this.transform.resize(width, height);\n    // TODO: 小程序环境不需要执行后续动作\n    if (isMini) {\n      return this;\n    }\n    const fireMoving = !this.moving;\n    if (fireMoving) {\n      this.stop();\n      this.emit('movestart', new $window.Event('movestart', eventData));\n      this.emit('move', new $window.Event('move', eventData));\n    }\n\n    this.emit('resize', new $window.Event('resize', eventData));\n\n    if (fireMoving) {\n      this.emit('moveend', new $window.Event('moveend', eventData));\n    }\n\n    return this;\n  }\n\n  public getContainer() {\n    return this.container;\n  }\n\n  public getCanvas() {\n    return this.canvas;\n  }\n\n  public getCanvasContainer() {\n    return this.canvasContainer;\n  }\n\n  public project(lngLat: LngLatLike) {\n    return this.transform.locationPoint(LngLat.convert(lngLat));\n  }\n\n  public unproject(point: PointLike) {\n    return this.transform.pointLocation(Point.convert(point));\n  }\n\n  public getBounds(): LngLatBounds {\n    return this.transform.getBounds();\n  }\n\n  public getMaxBounds(): LngLatBounds | null {\n    return this.transform.getMaxBounds();\n  }\n\n  public setMaxBounds(bounds: LngLatBoundsLike) {\n    this.transform.setMaxBounds(LngLatBounds.convert(bounds));\n  }\n\n  public setStyle(style: any) {\n    return;\n  }\n  public setMinZoom(minZoom?: number) {\n    minZoom =\n      minZoom === null || minZoom === undefined ? defaultMinZoom : minZoom;\n    if (minZoom >= defaultMinZoom && minZoom <= this.transform.maxZoom) {\n      this.transform.minZoom = minZoom;\n      if (this.getZoom() < minZoom) {\n        this.setZoom(minZoom);\n      }\n\n      return this;\n    } else {\n      throw new Error(\n        `minZoom must be between ${defaultMinZoom} and the current maxZoom, inclusive`,\n      );\n    }\n  }\n\n  public getMinZoom() {\n    return this.transform.minZoom;\n  }\n\n  public setMaxZoom(maxZoom?: number) {\n    maxZoom =\n      maxZoom === null || maxZoom === undefined ? defaultMaxZoom : maxZoom;\n\n    if (maxZoom >= this.transform.minZoom) {\n      this.transform.maxZoom = maxZoom;\n      if (this.getZoom() > maxZoom) {\n        this.setZoom(maxZoom);\n      }\n\n      return this;\n    } else {\n      throw new Error('maxZoom must be greater than the current minZoom');\n    }\n  }\n  public getMaxZoom() {\n    return this.transform.maxZoom;\n  }\n\n  public setMinPitch(minPitch?: number) {\n    minPitch =\n      minPitch === null || minPitch === undefined ? defaultMinPitch : minPitch;\n\n    if (minPitch < defaultMinPitch) {\n      throw new Error(\n        `minPitch must be greater than or equal to ${defaultMinPitch}`,\n      );\n    }\n\n    if (minPitch >= defaultMinPitch && minPitch <= this.transform.maxPitch) {\n      this.transform.minPitch = minPitch;\n      if (this.getPitch() < minPitch) {\n        this.setPitch(minPitch);\n      }\n\n      return this;\n    } else {\n      throw new Error(\n        `minPitch must be between ${defaultMinPitch} and the current maxPitch, inclusive`,\n      );\n    }\n  }\n\n  public getMinPitch() {\n    return this.transform.minPitch;\n  }\n\n  public setMaxPitch(maxPitch?: number) {\n    maxPitch =\n      maxPitch === null || maxPitch === undefined ? defaultMaxPitch : maxPitch;\n\n    if (maxPitch > defaultMaxPitch) {\n      throw new Error(\n        `maxPitch must be less than or equal to ${defaultMaxPitch}`,\n      );\n    }\n\n    if (maxPitch >= this.transform.minPitch) {\n      this.transform.maxPitch = maxPitch;\n      if (this.getPitch() > maxPitch) {\n        this.setPitch(maxPitch);\n      }\n\n      return this;\n    } else {\n      throw new Error('maxPitch must be greater than the current minPitch');\n    }\n  }\n\n  public getMaxPitch() {\n    return this.transform.maxPitch;\n  }\n\n  public getRenderWorldCopies() {\n    return this.transform.renderWorldCopies;\n  }\n\n  public setRenderWorldCopies(renderWorldCopies?: boolean) {\n    this.transform.renderWorldCopies = !!renderWorldCopies;\n  }\n\n  public remove() {\n    if (this.frame) {\n      this.frame.cancel();\n      this.frame = null;\n    }\n    this.renderTaskQueue.clear();\n  }\n\n  public requestRenderFrame(cb: CallBack): TaskID {\n    this.update();\n    return this.renderTaskQueue.add(cb);\n  }\n\n  public cancelRenderFrame(id: TaskID) {\n    return this.renderTaskQueue.remove(id);\n  }\n\n  public triggerRepaint() {\n    if (!this.frame) {\n      this.frame = renderframe((paintStartTimeStamp: number) => {\n        PerformanceUtils.frame(paintStartTimeStamp);\n        this.frame = null;\n        this.update(paintStartTimeStamp);\n      });\n    }\n  }\n\n  public update(time?: number) {\n    if (!this.frame) {\n      this.frame = renderframe((paintStartTimeStamp: number) => {\n        PerformanceUtils.frame(paintStartTimeStamp);\n        this.frame = null;\n        this.renderTaskQueue.run(time);\n      });\n    }\n  }\n\n  private initContainer() {\n    if (typeof this.options.container === 'string') {\n      this.container = window.document.getElementById(\n        this.options.container,\n      ) as HTMLElement;\n      if (!this.container) {\n        throw new Error(`Container '${this.options.container}' not found.`);\n      }\n    } else if (this.options.container instanceof HTMLElement) {\n      this.container = this.options.container;\n    } else {\n      throw new Error(\n        \"Invalid type: 'container' must be a String or HTMLElement.\",\n      );\n    }\n\n    const container = this.container;\n    container.classList.add('l7-map');\n\n    const canvasContainer = (this.canvasContainer = DOM.create(\n      'div',\n      'l7-canvas-container',\n      container,\n    ));\n    if (this.options.interactive) {\n      canvasContainer.classList.add('l7-interactive');\n    }\n  }\n\n  /**\n   * 小程序环境构建容器\n   */\n  private initMiniContainer() {\n    this.container = this.options.canvas as HTMLCanvasElement;\n    this.canvasContainer = this.container;\n  }\n\n  private containerDimensions(): [number, number] {\n    let width = 0;\n    let height = 0;\n    if (this.container) {\n      if (isMini) {\n        width =\n          (this.container as HTMLCanvasElement).width /\n          $window.devicePixelRatio;\n        height =\n          (this.container as HTMLCanvasElement).height /\n          $window.devicePixelRatio;\n      } else {\n        width = this.container.clientWidth;\n        height = this.container.clientHeight;\n      }\n    }\n    return [width, height];\n  }\n\n  private onWindowOnline = () => {\n    this.update();\n  };\n\n  private onWindowResize = (event: Event) => {\n    if (this.trackResize) {\n      this.resize({ originalEvent: event }).update();\n    }\n  };\n}\n"],"file":"map.js"}