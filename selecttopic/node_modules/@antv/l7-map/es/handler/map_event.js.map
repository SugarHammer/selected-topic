{"version":3,"sources":["../../src/handler/map_event.ts"],"names":["MapMouseEvent","MapTouchEvent","MapWheelEvent","MapEventHandler","map","options","clickTolerance","mousedownPos","e","firePreventable","type","point","emit","dist","mapEvent","defaultPrevented"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport { EarthMap } from '../earthmap';\nimport Point from '../geo/point';\nimport { Map } from '../map';\nimport { MapMouseEvent, MapTouchEvent, MapWheelEvent } from './events';\n\nexport default class MapEventHandler {\n  private mousedownPos: Point;\n  private clickTolerance: number;\n  private map: Map | EarthMap;\n\n  constructor(map: Map | EarthMap, options: { clickTolerance: number }) {\n    this.map = map;\n    this.clickTolerance = options.clickTolerance;\n  }\n\n  public reset() {\n    // @ts-ignore\n    delete this.mousedownPos;\n  }\n\n  public wheel(e: WheelEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - ScrollZoom\n    return this.firePreventable(new MapWheelEvent(e.type, this.map, e));\n  }\n\n  public mousedown(e: MouseEvent, point: Point) {\n    this.mousedownPos = point;\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - MousePan\n    // - MouseRotate\n    // - MousePitch\n    // - DblclickHandler\n    return this.firePreventable(new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseup(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public click(e: MouseEvent, point: Point) {\n    if (\n      this.mousedownPos &&\n      this.mousedownPos.dist(point) >= this.clickTolerance\n    ) {\n      return;\n    }\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public dblclick(e: MouseEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - DblClickZoom\n    return this.firePreventable(new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseover(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseout(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public touchstart(e: TouchEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - TouchPan\n    // - TouchZoom\n    // - TouchRotate\n    // - TouchPitch\n    // - TapZoom\n    // - SwipeZoom\n    return this.firePreventable(new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchmove(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchend(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchcancel(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public firePreventable(\n    mapEvent: MapMouseEvent | MapTouchEvent | MapWheelEvent,\n  ) {\n    this.map.emit(mapEvent.type, mapEvent);\n    if (mapEvent.defaultPrevented) {\n      // returning an object marks the handler as active and resets other handlers\n      return {};\n    }\n  }\n\n  public isEnabled() {\n    return true;\n  }\n\n  public isActive() {\n    return false;\n  }\n  public enable() {\n    return false;\n  }\n  public disable() {\n    return false;\n  }\n}\n"],"file":"map_event.js"}