{"version":3,"sources":["../../src/earth/index.ts"],"names":["BaseLayer","EarthAtomSphereModel","BaseEarthModel","EarthBloomSphereModel","EarthModels","base","atomSphere","bloomSphere","earthLayerTypes","EarthLayer","shape","getModelType","layerModel","models","initModels","time","setEarthTime","console","error","shapeAttribute","styleAttributeService","getLayerStyleAttribute","scale","field","indexOf"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,SAAP,MAAsB,mBAAtB;AACA,OAAOC,oBAAP,MAAiC,qBAAjC;AACA,OAAOC,cAAP,MAA2B,eAA3B;AACA,OAAOC,qBAAP,MAAkC,sBAAlC;AASA,IAAMC,WAA6C,GAAG;AACpDC,EAAAA,IAAI,EAAEH,cAD8C;AAEpDI,EAAAA,UAAU,EAAEL,oBAFwC;AAGpDM,EAAAA,WAAW,EAAEJ;AAHuC,CAAtD;AAMA,IAAMK,eAAe,GAAG,CAAC,MAAD,EAAS,YAAT,EAAuB,aAAvB,CAAxB;;IAEqBC,U;;;;;;;;;;;;;;;;2DACG,Y;;;;;;;WAEtB,uBAAqB;AACnB,UAAMC,KAAK,GAAG,KAAKC,YAAL,EAAd;AACA,WAAKC,UAAL,GAAkB,IAAIR,WAAW,CAACM,KAAD,CAAf,CAAuB,IAAvB,CAAlB;AACA,WAAKG,MAAL,GAAc,KAAKD,UAAL,CAAgBE,UAAhB,EAAd;AACD;;;WAMD,sBAAoBC,IAApB,EAAkC;AAChC,UAAI,KAAKH,UAAL,IAAmB,KAAKA,UAAL,CAAgBI,YAAvC,EAAqD;AACnD,aAAKJ,UAAL,CAAgBI,YAAhB,CAA6BD,IAA7B;AACD,OAFD,MAEO;AACLE,QAAAA,OAAO,CAACC,KAAR,CAAc,0BAAd;AACD;AACF;;;WAED,wBAAyC;AAAA;;AACvC,UAAMC,cAAc,GAAG,KAAKC,qBAAL,CAA2BC,sBAA3B,CACrB,OADqB,CAAvB;AAGA,UAAIX,KAAK,GAAI,CAAAS,cAAc,SAAd,IAAAA,cAAc,WAAd,qCAAAA,cAAc,CAAEG,KAAhB,gFAAuBC,KAAvB,KAAgC,MAA7C;;AACA,UAAIf,eAAe,CAACgB,OAAhB,CAAwBd,KAAxB,IAAiC,CAArC,EAAwC;AACtCA,QAAAA,KAAK,GAAG,MAAR;AACD;;AACD,aAAOA,KAAP;AACD;;;;EA9BqCV,S;;SAAnBS,U","sourcesContent":["import BaseLayer from '../core/BaseLayer';\nimport EarthAtomSphereModel from './models/atmosphere';\nimport BaseEarthModel from './models/base';\nimport EarthBloomSphereModel from './models/bloomsphere';\n\ninterface IEarthLayerStyleOptions {\n  opacity: number;\n  setEarthTime(time: number): void;\n}\n\nexport type EarthModelType = 'base' | 'atomSphere' | 'bloomSphere';\n\nconst EarthModels: { [key in EarthModelType]: any } = {\n  base: BaseEarthModel,\n  atomSphere: EarthAtomSphereModel,\n  bloomSphere: EarthBloomSphereModel,\n};\n\nconst earthLayerTypes = ['base', 'atomSphere', 'bloomSphere'];\n\nexport default class EarthLayer extends BaseLayer<IEarthLayerStyleOptions> {\n  public type: string = 'EarthLayer';\n\n  public buildModels() {\n    const shape = this.getModelType();\n    this.layerModel = new EarthModels[shape](this);\n    this.models = this.layerModel.initModels();\n  }\n\n  /**\n   * 设置当前地球时间\n   * @param time\n   */\n  public setEarthTime(time: number) {\n    if (this.layerModel && this.layerModel.setEarthTime) {\n      this.layerModel.setEarthTime(time);\n    } else {\n      console.error('请在 scene loaded 之后执行该方法！');\n    }\n  }\n\n  protected getModelType(): EarthModelType {\n    const shapeAttribute = this.styleAttributeService.getLayerStyleAttribute(\n      'shape',\n    );\n    let shape = (shapeAttribute?.scale?.field || 'base') as string;\n    if (earthLayerTypes.indexOf(shape) < 0) {\n      shape = 'base';\n    }\n    return shape as EarthModelType;\n  }\n}\n"],"file":"index.js"}